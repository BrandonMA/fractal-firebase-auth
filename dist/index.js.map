{"version":3,"file":"index.js","sources":["../src/redux/thunks/Authentication/signIn.ts","../src/redux/thunks/Authentication/signOut.ts","../src/redux/thunks/Authentication/signUp.ts","../src/redux/slices/createAuthenticationSlice.ts","../src/Firebase.tsx","../src/redux/types/AuthenticationState.ts","../src/redux/types/MinimalExpectedReduxState.ts","../src/redux/hooks/useAuthenticationState.tsx","../src/redux/types/UsersState.ts","../src/redux/hooks/useCurrentUser.tsx","../src/redux/thunks/Authentication/subscribeForAuthenticatedUser.ts","../src/Authenticate.tsx","../src/redux/slices/createUsersSlice.ts"],"sourcesContent":["import { createAsyncThunk } from '@reduxjs/toolkit';\nimport * as firebase from 'firebase/app';\nimport 'firebase/auth';\nimport { AuthenticationState } from '../../types/AuthenticationState';\nimport { EmailPasswordPair } from '../../types/EmailPasswordPair';\n\nexport const signIn = createAsyncThunk(\n    'authentication/signIn',\n    async (user: EmailPasswordPair): Promise<AuthenticationState> => {\n        const userCredential = await firebase.auth().signInWithEmailAndPassword(user.email, user.password);\n        return {\n            firebaseUser: userCredential.user,\n            loading: false\n        };\n    }\n);\n","import { createAsyncThunk } from '@reduxjs/toolkit';\nimport * as firebase from 'firebase/app';\nimport 'firebase/auth';\nimport { AuthenticationState } from '../../types/AuthenticationState';\n\nexport const signOut = createAsyncThunk(\n    'authentication/signOut',\n    async (): Promise<AuthenticationState> => {\n        await firebase.auth().signOut();\n        return {\n            firebaseUser: undefined,\n            loading: false\n        };\n    }\n);\n","import { createAsyncThunk } from '@reduxjs/toolkit';\nimport * as firebase from 'firebase/app';\nimport 'firebase/auth';\nimport { AuthenticationState } from '../../types/AuthenticationState';\nimport { EmailPasswordPair } from '../../types/EmailPasswordPair';\n\nexport const signUp = createAsyncThunk(\n    'authentication/signUp',\n    async (user: EmailPasswordPair): Promise<AuthenticationState> => {\n        const userCredential = await firebase.auth().createUserWithEmailAndPassword(user.email, user.password);\n        return {\n            firebaseUser: userCredential.user,\n            loading: false\n        };\n    }\n);\n","import { createSlice, PayloadAction, ActionCreatorWithPreparedPayload } from '@reduxjs/toolkit';\nimport { AuthenticationState } from '../types/AuthenticationState';\nimport { signIn } from '../thunks/Authentication/signIn';\nimport { signOut } from '../thunks/Authentication/signOut';\nimport { signUp } from '../thunks/Authentication/signUp';\nimport * as firebase from 'firebase/app';\n\nconst initialState: Readonly<AuthenticationState> = Object.freeze({\n    firebaseUser: undefined,\n    loading: true\n});\n\ntype ReducerFunction = (state: AuthenticationState, action: PayloadAction<AuthenticationState>) => void;\ninterface ExtraReducers<ThunkArg = void> {\n    [key: string]: {\n        callback: ReducerFunction;\n        fullfilled: ActionCreatorWithPreparedPayload<[AuthenticationState, string, ThunkArg], AuthenticationState, string, never>;\n    };\n}\n\n// eslint-disable-next-line\nexport function createAuthenticationSlice<ThunkArg = void>(reducers?: ExtraReducers<ThunkArg>, extraReducers?: ExtraReducers<ThunkArg>) {\n    return createSlice({\n        name: 'authentication',\n        initialState,\n        reducers: {\n            setFirebaseUser: (state, action: PayloadAction<firebase.User | null | undefined>): void => {\n                state.firebaseUser = action.payload;\n            },\n            setLoadingFirebaseData: (state, action: PayloadAction<boolean>): void => {\n                state.loading = action.payload;\n            },\n            setAuthenticationState: (state, action: PayloadAction<AuthenticationState>): void => {\n                // Used to bypass the has not been read rule\n                if (state != null) {\n                    state = action.payload;\n                }\n            },\n            ...reducers\n        },\n        extraReducers: (builder) => {\n            const replaceAuthenticationState = (state: AuthenticationState, action: PayloadAction<AuthenticationState>): void => {\n                // Used to bypass the has not been read rule\n                if (state != null) {\n                    state = action.payload;\n                }\n            };\n\n            builder.addCase(signIn.fulfilled, replaceAuthenticationState);\n            builder.addCase(signOut.fulfilled, replaceAuthenticationState);\n            builder.addCase(signUp.fulfilled, replaceAuthenticationState);\n\n            // Inject extra reducers\n            if (extraReducers != null) {\n                const keys = Object.keys(extraReducers);\n                if (keys.length > 0) {\n                    for (const reducerKey of keys) {\n                        const data = extraReducers[reducerKey];\n                        builder.addCase(data.fullfilled, data.callback);\n                    }\n                }\n            }\n        }\n    });\n}\n\nexport type AuthenticationSlice = ReturnType<typeof createAuthenticationSlice>;\n","import * as firebase from 'firebase/app';\nimport { useState, useEffect } from 'react';\nimport { createAuthenticationSlice } from './redux/slices/createAuthenticationSlice';\n\nconst authSlice = createAuthenticationSlice();\nauthSlice.actions.setLoadingFirebaseData(false);\n\ninterface Config {\n    [key: string]: string;\n}\n\ninterface Props {\n    children: JSX.Element;\n    firebaseConfig: Config;\n    loadingComponent: JSX.Element;\n}\n\nexport function Firebase(props: Props): JSX.Element {\n    const [firebaseReady, setFirebaseReady] = useState(false);\n    const { firebaseConfig } = props;\n\n    useEffect(() => {\n        firebase.initializeApp(firebaseConfig);\n        setFirebaseReady(true);\n    }, [firebaseConfig]);\n\n    return firebaseReady ? props.children : props.loadingComponent;\n}\n","import * as firebase from 'firebase/app';\n\nexport interface AuthenticationState {\n    firebaseUser: firebase.User | undefined | null;\n    loading: boolean;\n}\n\nexport function isAuthenticationState(value: unknown): value is AuthenticationState {\n    const castedValue = value as AuthenticationState;\n    return castedValue.loading != null;\n}\n","import { AuthenticationState, isAuthenticationState } from './AuthenticationState';\nimport { UsersState } from './UsersState';\nimport { MinimalUserData } from './MinimalUser';\n\nexport type MinimalExpectedReduxState = {\n    authentication: AuthenticationState;\n    users: UsersState<MinimalUserData, unknown>;\n};\n\nexport function isMinimalExpectedReduxState(value: unknown): value is MinimalExpectedReduxState {\n    const castedValue = value as MinimalExpectedReduxState;\n    return castedValue.authentication != null && isAuthenticationState(castedValue.authentication) && castedValue.users != null;\n}\n","import { useSelector } from 'react-redux';\nimport { AuthenticationState } from '../types/AuthenticationState';\nimport { isMinimalExpectedReduxState } from '../types/MinimalExpectedReduxState';\n\nconst getState = (state: unknown): Readonly<AuthenticationState> => {\n    if (isMinimalExpectedReduxState(state)) {\n        return state.authentication;\n    } else {\n        throw Error('State does not have the expected shape');\n    }\n};\n\nexport const useAuthenticationState = (): Readonly<AuthenticationState> => {\n    return useSelector(getState);\n};\n","import { MinimalUser, MinimalUserData } from './MinimalUser';\n\nexport interface UsersState<T extends MinimalUserData, S> {\n    values: Map<string, MinimalUser<T, S>>;\n}\n\nexport function isUsersState<T extends MinimalUserData, S>(value: unknown): value is UsersState<T, S> {\n    const casted = value as UsersState<T, S>;\n    return casted.values != null;\n}\n","import { useSelector } from 'react-redux';\nimport { MinimalUser, MinimalUserData } from '../types/MinimalUser';\nimport { useAuthenticationState } from './useAuthenticationState';\nimport { isMinimalExpectedReduxState, UsersState, isUsersState } from '../types';\n\nfunction getUsers<T extends MinimalUserData, S>(state: unknown): Readonly<UsersState<T, S>> {\n    if (isMinimalExpectedReduxState(state) && isUsersState<T, S>(state.users)) {\n        return state.users;\n    } else {\n        throw Error('State does not have the expected shape');\n    }\n}\n\nexport function useCurrentUser<T extends MinimalUserData, S>(): MinimalUser<T, S> | null | undefined {\n    const authState = useAuthenticationState();\n    const users = useSelector(getUsers);\n    if (authState.firebaseUser != null) {\n        return users.values.get(authState.firebaseUser.uid) as MinimalUser<T, S> | null | undefined;\n    } else {\n        return null;\n    }\n}\n","import firebase from 'firebase/app';\nimport 'firebase/auth';\nimport { ThunkDispatch } from 'redux-thunk';\nimport { Action } from 'redux';\nimport { AuthenticationSlice, MinimalExpectedReduxState } from '../..';\n\nconst subscribeForAuthenticatedUser = (slice: AuthenticationSlice) => (\n    dispatch: ThunkDispatch<firebase.Unsubscribe, MinimalExpectedReduxState, Action>\n): firebase.Unsubscribe => {\n    return firebase.auth().onAuthStateChanged(\n        (user) => {\n            dispatch(\n                slice.actions.setAuthenticationState({\n                    firebaseUser: user,\n                    loading: false\n                })\n            );\n        },\n        (error) => {\n            alert(error.message);\n        }\n    );\n};\n\nexport default subscribeForAuthenticatedUser;\n","import { useAuthenticationState } from './redux/hooks/useAuthenticationState';\nimport { useCurrentUser } from './redux/hooks/useCurrentUser';\nimport { ThunkDispatch } from 'redux-thunk';\nimport { MinimalExpectedReduxState, AuthenticationSlice } from './redux';\nimport { Action } from 'redux';\nimport subscribeForAuthenticatedUserThunk from './redux/thunks/Authentication/subscribeForAuthenticatedUser';\nimport { connect } from 'react-redux';\nimport { useEffect } from 'react';\n\ninterface ReduxFunctions {\n    subscribeForAuthenticatedUser: () => firebase.Unsubscribe;\n}\n\ninterface OwnProps {\n    authenticationSlice: AuthenticationSlice;\n    loadingComponent: JSX.Element;\n    authenticationComponent: JSX.Element;\n    userNotAvailableComponent: JSX.Element;\n    children: JSX.Element;\n}\n\ninterface Props extends OwnProps, ReduxFunctions {}\n\nexport function Authenticate(props: Props): JSX.Element {\n    const authenticationState = useAuthenticationState();\n    const currentUser = useCurrentUser();\n\n    const { subscribeForAuthenticatedUser } = props;\n\n    useEffect(() => {\n        const unsubscribe = subscribeForAuthenticatedUser();\n        return (): void => {\n            unsubscribe(); // Remove auth listening when the component is unmounted.\n        };\n    }, [subscribeForAuthenticatedUser]);\n\n    if (authenticationState.firebaseUser === undefined && authenticationState.loading) {\n        return props.loadingComponent;\n    } else if (authenticationState.firebaseUser === null && authenticationState.loading === false) {\n        return props.authenticationComponent;\n    } else {\n        if (currentUser == null) {\n            return props.userNotAvailableComponent;\n        } else {\n            return props.children;\n        }\n    }\n}\n\nconst mapDispatchToProps = (dispatch: ThunkDispatch<void, MinimalExpectedReduxState, Action>, ownProps: OwnProps): ReduxFunctions => ({\n    subscribeForAuthenticatedUser(): firebase.Unsubscribe {\n        return dispatch(subscribeForAuthenticatedUserThunk(ownProps.authenticationSlice));\n    }\n});\n\nexport default connect(null, mapDispatchToProps)(Authenticate);\n","import { createSlice, PayloadAction, ActionCreatorWithPreparedPayload } from '@reduxjs/toolkit';\nimport { UsersState } from '../types/UsersState';\nimport { MinimalUserData, MinimalUser } from '../types/MinimalUser';\n\ntype UsersMinimalState = UsersState<MinimalUserData, unknown>;\n\nconst initialState: Readonly<UsersMinimalState> = Object.freeze({\n    values: new Map()\n});\n\ntype ReducerFunction = (state: UsersMinimalState, action: PayloadAction<UsersMinimalState>) => void;\ninterface ExtraReducers<ThunkArg = void> {\n    [key: string]: {\n        callback: ReducerFunction;\n        fullfilled: ActionCreatorWithPreparedPayload<[UsersMinimalState, string, ThunkArg], UsersMinimalState, string, never>;\n    };\n}\n\n// eslint-disable-next-line\nexport function createUsersSlice<T extends MinimalUserData, S, ThunkArg = void>(\n    reducers?: ExtraReducers<ThunkArg>,\n    extraReducers?: ExtraReducers<ThunkArg>\n) {\n    return createSlice({\n        name: 'users',\n        initialState,\n        reducers: {\n            setUser: (state, action: PayloadAction<MinimalUser<T, S>>): void => {\n                state.values.set(action.payload.id(), action.payload);\n            },\n            ...reducers\n        },\n        extraReducers: (builder) => {\n            // Inject extra reducers\n            if (extraReducers != null) {\n                const keys = Object.keys(extraReducers);\n                if (keys.length > 0) {\n                    for (const reducerKey of keys) {\n                        const data = extraReducers[reducerKey];\n                        builder.addCase(data.fullfilled, data.callback);\n                    }\n                }\n            }\n        }\n    });\n}\n\nexport type UsersSlice = ReturnType<typeof createUsersSlice>;\n"],"names":["signIn","createAsyncThunk","user","firebase","signInWithEmailAndPassword","email","password","userCredential","firebaseUser","loading","signOut","undefined","signUp","createUserWithEmailAndPassword","initialState","Object","freeze","createAuthenticationSlice","reducers","extraReducers","createSlice","name","setFirebaseUser","state","action","payload","setLoadingFirebaseData","setAuthenticationState","builder","replaceAuthenticationState","addCase","fulfilled","keys","length","reducerKey","data","fullfilled","callback","authSlice","actions","Firebase","props","useState","firebaseReady","setFirebaseReady","firebaseConfig","useEffect","children","loadingComponent","isAuthenticationState","value","castedValue","isMinimalExpectedReduxState","authentication","users","getState","Error","useAuthenticationState","useSelector","isUsersState","casted","values","getUsers","useCurrentUser","authState","get","uid","subscribeForAuthenticatedUser","slice","dispatch","auth","onAuthStateChanged","error","alert","message","Authenticate","authenticationState","currentUser","unsubscribe","authenticationComponent","userNotAvailableComponent","mapDispatchToProps","ownProps","subscribeForAuthenticatedUserThunk","authenticationSlice","connect","Map","createUsersSlice","setUser","set","id"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAMaA,MAAM,GAAGC,wBAAgB,CAClC,uBADkC,YAE3BC,IAF2B;AAAA;2BAGDC,aAAA,GAAgBC,0BAAhB,CAA2CF,IAAI,CAACG,KAAhD,EAAuDH,IAAI,CAACI,QAA5D,kBAAvBC;AACN,aAAO;AACHC,QAAAA,YAAY,EAAED,cAAc,CAACL,IAD1B;AAEHO,QAAAA,OAAO,EAAE;AAFN,OAAP;;AAIH,GARiC;AAAA;AAAA;AAAA;;ICDzBC,OAAO,GAAGT,wBAAgB,CACnC,wBADmC;AAAA;2BAGzBE,aAAA,GAAgBO,OAAhB;AACN,aAAO;AACHF,QAAAA,YAAY,EAAEG,SADX;AAEHF,QAAAA,OAAO,EAAE;AAFN,OAAP;;AAIH,GARkC;AAAA;AAAA;AAAA,EAAhC;;ICCMG,MAAM,GAAGX,wBAAgB,CAClC,uBADkC,YAE3BC,IAF2B;AAAA;2BAGDC,aAAA,GAAgBU,8BAAhB,CAA+CX,IAAI,CAACG,KAApD,EAA2DH,IAAI,CAACI,QAAhE,kBAAvBC;AACN,aAAO;AACHC,QAAAA,YAAY,EAAED,cAAc,CAACL,IAD1B;AAEHO,QAAAA,OAAO,EAAE;AAFN,OAAP;;AAIH,GARiC;AAAA;AAAA;AAAA,EAA/B;;ACCP,IAAMK,YAAY,GAAkCC,MAAM,CAACC,MAAP,CAAc;AAC9DR,EAAAA,YAAY,EAAEG,SADgD;AAE9DF,EAAAA,OAAO,EAAE;AAFqD,CAAd,CAApD;AAcA,SAAgBQ,0BAA2CC,UAAoCC;AAC3F,SAAOC,mBAAW,CAAC;AACfC,IAAAA,IAAI,EAAE,gBADS;AAEfP,IAAAA,YAAY,EAAZA,YAFe;AAGfI,IAAAA,QAAQ;AACJI,MAAAA,eAAe,EAAE,yBAACC,KAAD,EAAQC,MAAR;AACbD,QAAAA,KAAK,CAACf,YAAN,GAAqBgB,MAAM,CAACC,OAA5B;AACH,OAHG;AAIJC,MAAAA,sBAAsB,EAAE,gCAACH,KAAD,EAAQC,MAAR;AACpBD,QAAAA,KAAK,CAACd,OAAN,GAAgBe,MAAM,CAACC,OAAvB;AACH,OANG;AAOJE,MAAAA,sBAAsB,EAAE,gCAACJ,KAAD,EAAQC,MAAR;AAEpB,AAGH;AAZG,OAaDN,QAbC,CAHO;AAkBfC,IAAAA,aAAa,EAAE,uBAACS,OAAD;AACX,UAAMC,0BAA0B,GAAG,SAA7BA,0BAA6B,CAACN,KAAD,EAA6BC,MAA7B;AAE/B,AAGH,OALD;;AAOAI,MAAAA,OAAO,CAACE,OAAR,CAAgB9B,MAAM,CAAC+B,SAAvB,EAAkCF,0BAAlC;AACAD,MAAAA,OAAO,CAACE,OAAR,CAAgBpB,OAAO,CAACqB,SAAxB,EAAmCF,0BAAnC;AACAD,MAAAA,OAAO,CAACE,OAAR,CAAgBlB,MAAM,CAACmB,SAAvB,EAAkCF,0BAAlC;;AAGA,UAAIV,cAAa,IAAI,IAArB,EAA2B;AACvB,YAAMa,IAAI,GAAGjB,MAAM,CAACiB,IAAP,CAAYb,cAAZ,CAAb;;AACA,YAAIa,IAAI,CAACC,MAAL,GAAc,CAAlB,EAAqB;AACjB,+DAAyBD,IAAzB,wCAA+B;AAAA,gBAApBE,UAAoB;AAC3B,gBAAMC,IAAI,GAAGhB,cAAa,CAACe,UAAD,CAA1B;AACAN,YAAAA,OAAO,CAACE,OAAR,CAAgBK,IAAI,CAACC,UAArB,EAAiCD,IAAI,CAACE,QAAtC;AACH;AACJ;AACJ;AACJ;AAxCc,GAAD,CAAlB;AA0CH;;AC5DD,IAAMC,SAAS,GAAGrB,yBAAyB,EAA3C;AACAqB,SAAS,CAACC,OAAV,CAAkBb,sBAAlB,CAAyC,KAAzC;AAYA,SAAgBc,SAASC;kBACqBC,cAAQ,CAAC,KAAD;MAA3CC;MAAeC;;MACdC,iBAAmBJ,MAAnBI;AAERC,EAAAA,eAAS,CAAC;AACN3C,IAAAA,sBAAA,CAAuB0C,cAAvB;AACAD,IAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACH,GAHQ,EAGN,CAACC,cAAD,CAHM,CAAT;AAKA,SAAOF,aAAa,GAAGF,KAAK,CAACM,QAAT,GAAoBN,KAAK,CAACO,gBAA9C;AACH;;SCpBeC,sBAAsBC;AAClC,MAAMC,WAAW,GAAGD,KAApB;AACA,SAAOC,WAAW,CAAC1C,OAAZ,IAAuB,IAA9B;AACH;;SCDe2C,4BAA4BF;AACxC,MAAMC,WAAW,GAAGD,KAApB;AACA,SAAOC,WAAW,CAACE,cAAZ,IAA8B,IAA9B,IAAsCJ,qBAAqB,CAACE,WAAW,CAACE,cAAb,CAA3D,IAA2FF,WAAW,CAACG,KAAZ,IAAqB,IAAvH;AACH;;ACRD,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAChC,KAAD;AACb,MAAI6B,2BAA2B,CAAC7B,KAAD,CAA/B,EAAwC;AACpC,WAAOA,KAAK,CAAC8B,cAAb;AACH,GAFD,MAEO;AACH,UAAMG,KAAK,CAAC,wCAAD,CAAX;AACH;AACJ,CAND;;AAQA,IAAaC,sBAAsB,GAAG,SAAzBA,sBAAyB;AAClC,SAAOC,sBAAW,CAACH,QAAD,CAAlB;AACH,CAFM;;SCNSI,aAA2CT;AACvD,MAAMU,MAAM,GAAGV,KAAf;AACA,SAAOU,MAAM,CAACC,MAAP,IAAiB,IAAxB;AACH;;ACJD,SAASC,QAAT,CAAgDvC,KAAhD;AACI,MAAI6B,2BAA2B,CAAC7B,KAAD,CAA3B,IAAsCoC,YAAY,CAAOpC,KAAK,CAAC+B,KAAb,CAAtD,EAA2E;AACvE,WAAO/B,KAAK,CAAC+B,KAAb;AACH,GAFD,MAEO;AACH,UAAME,KAAK,CAAC,wCAAD,CAAX;AACH;AACJ;;AAED,SAAgBO;AACZ,MAAMC,SAAS,GAAGP,sBAAsB,EAAxC;AACA,MAAMH,KAAK,GAAGI,sBAAW,CAACI,QAAD,CAAzB;;AACA,MAAIE,SAAS,CAACxD,YAAV,IAA0B,IAA9B,EAAoC;AAChC,WAAO8C,KAAK,CAACO,MAAN,CAAaI,GAAb,CAAiBD,SAAS,CAACxD,YAAV,CAAuB0D,GAAxC,CAAP;AACH,GAFD,MAEO;AACH,WAAO,IAAP;AACH;AACJ;;ACfD,IAAMC,6BAA6B,GAAG,SAAhCA,6BAAgC,CAACC,KAAD;AAAA,SAAgC,UAClEC,QADkE;AAGlE,WAAOlE,iBAAQ,CAACmE,IAAT,GAAgBC,kBAAhB,CACH,UAACrE,IAAD;AACImE,MAAAA,QAAQ,CACJD,KAAK,CAAC7B,OAAN,CAAcZ,sBAAd,CAAqC;AACjCnB,QAAAA,YAAY,EAAEN,IADmB;AAEjCO,QAAAA,OAAO,EAAE;AAFwB,OAArC,CADI,CAAR;AAMH,KARE,EASH,UAAC+D,KAAD;AACIC,MAAAA,KAAK,CAACD,KAAK,CAACE,OAAP,CAAL;AACH,KAXE,CAAP;AAaH,GAhBqC;AAAA,CAAtC;;SCiBgBC,aAAalC;AACzB,MAAMmC,mBAAmB,GAAGnB,sBAAsB,EAAlD;AACA,MAAMoB,WAAW,GAAGd,cAAc,EAAlC;MAEQI,gCAAkC1B,MAAlC0B;AAERrB,EAAAA,eAAS,CAAC;AACN,QAAMgC,WAAW,GAAGX,6BAA6B,EAAjD;AACA,WAAO;AACHW,MAAAA,WAAW;AACd,KAFD;AAGH,GALQ,EAKN,CAACX,6BAAD,CALM,CAAT;;AAOA,MAAIS,mBAAmB,CAACpE,YAApB,KAAqCG,SAArC,IAAkDiE,mBAAmB,CAACnE,OAA1E,EAAmF;AAC/E,WAAOgC,KAAK,CAACO,gBAAb;AACH,GAFD,MAEO,IAAI4B,mBAAmB,CAACpE,YAApB,KAAqC,IAArC,IAA6CoE,mBAAmB,CAACnE,OAApB,KAAgC,KAAjF,EAAwF;AAC3F,WAAOgC,KAAK,CAACsC,uBAAb;AACH,GAFM,MAEA;AACH,QAAIF,WAAW,IAAI,IAAnB,EAAyB;AACrB,aAAOpC,KAAK,CAACuC,yBAAb;AACH,KAFD,MAEO;AACH,aAAOvC,KAAK,CAACM,QAAb;AACH;AACJ;AACJ;;AAED,IAAMkC,kBAAkB,GAAG,SAArBA,kBAAqB,CAACZ,QAAD,EAAmEa,QAAnE;AAAA,SAA2G;AAClIf,IAAAA,6BADkI;AAE9H,aAAOE,QAAQ,CAACc,6BAAkC,CAACD,QAAQ,CAACE,mBAAV,CAAnC,CAAf;AACH;AAHiI,GAA3G;AAAA,CAA3B;;AAMA,AAAeC,kBAAO,CAAC,IAAD,EAAOJ,kBAAP,CAAP,CAAkCN,YAAlC,CAAf;;ACjDA,IAAM7D,cAAY,GAAgCC,MAAM,CAACC,MAAP,CAAc;AAC5D6C,EAAAA,MAAM,EAAE,IAAIyB,GAAJ;AADoD,CAAd,CAAlD;AAaA,SAAgBC,iBACZrE,UACAC;AAEA,SAAOC,mBAAW,CAAC;AACfC,IAAAA,IAAI,EAAE,OADS;AAEfP,IAAAA,YAAY,EAAZA,cAFe;AAGfI,IAAAA,QAAQ;AACJsE,MAAAA,OAAO,EAAE,iBAACjE,KAAD,EAAQC,MAAR;AACLD,QAAAA,KAAK,CAACsC,MAAN,CAAa4B,GAAb,CAAiBjE,MAAM,CAACC,OAAP,CAAeiE,EAAf,EAAjB,EAAsClE,MAAM,CAACC,OAA7C;AACH;AAHG,OAIDP,QAJC,CAHO;AASfC,IAAAA,aAAa,EAAE,uBAACS,OAAD;AAEX,UAAIT,cAAa,IAAI,IAArB,EAA2B;AACvB,YAAMa,IAAI,GAAGjB,MAAM,CAACiB,IAAP,CAAYb,cAAZ,CAAb;;AACA,YAAIa,IAAI,CAACC,MAAL,GAAc,CAAlB,EAAqB;AACjB,+DAAyBD,IAAzB,wCAA+B;AAAA,gBAApBE,UAAoB;AAC3B,gBAAMC,IAAI,GAAGhB,cAAa,CAACe,UAAD,CAA1B;AACAN,YAAAA,OAAO,CAACE,OAAR,CAAgBK,IAAI,CAACC,UAArB,EAAiCD,IAAI,CAACE,QAAtC;AACH;AACJ;AACJ;AACJ;AApBc,GAAD,CAAlB;AAsBH;;;;;;;;;;;;;;;"}