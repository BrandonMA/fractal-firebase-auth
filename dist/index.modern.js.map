{"version":3,"file":"index.modern.js","sources":["../src/redux/thunks/Authentication/signIn.ts","../src/redux/thunks/Authentication/signOut.ts","../src/redux/thunks/Authentication/signUp.ts","../src/redux/slices/createAuthenticationSlice.ts","../src/Firebase.tsx","../src/redux/types/AuthenticationState.ts","../src/redux/types/MinimalExpectedReduxState.ts","../src/redux/hooks/useAuthenticationState.tsx","../src/redux/types/UsersState.ts","../src/redux/hooks/useCurrentUser.tsx","../src/Authenticate.tsx","../src/redux/slices/createUsersSlice.ts"],"sourcesContent":["import { createAsyncThunk } from '@reduxjs/toolkit';\nimport * as firebase from 'firebase/app';\nimport 'firebase/auth';\nimport { AuthenticationState } from '../../types/AuthenticationState';\nimport { EmailPasswordPair } from '../../types/EmailPasswordPair';\n\nexport const signIn = createAsyncThunk(\n    'authentication/signIn',\n    async (user: EmailPasswordPair): Promise<AuthenticationState> => {\n        const userCredential = await firebase.auth().signInWithEmailAndPassword(user.email, user.password);\n        return {\n            firebaseUser: userCredential.user,\n            loading: false\n        };\n    }\n);\n","import { createAsyncThunk } from '@reduxjs/toolkit';\nimport * as firebase from 'firebase/app';\nimport 'firebase/auth';\nimport { AuthenticationState } from '../../types/AuthenticationState';\n\nexport const signOut = createAsyncThunk(\n    'authentication/signOut',\n    async (): Promise<AuthenticationState> => {\n        await firebase.auth().signOut();\n        return {\n            firebaseUser: undefined,\n            loading: false\n        };\n    }\n);\n","import { createAsyncThunk } from '@reduxjs/toolkit';\nimport * as firebase from 'firebase/app';\nimport 'firebase/auth';\nimport { AuthenticationState } from '../../types/AuthenticationState';\nimport { EmailPasswordPair } from '../../types/EmailPasswordPair';\n\nexport const signUp = createAsyncThunk(\n    'authentication/signUp',\n    async (user: EmailPasswordPair): Promise<AuthenticationState> => {\n        const userCredential = await firebase.auth().createUserWithEmailAndPassword(user.email, user.password);\n        return {\n            firebaseUser: userCredential.user,\n            loading: false\n        };\n    }\n);\n","import { createSlice, PayloadAction, ActionCreatorWithPreparedPayload } from '@reduxjs/toolkit';\nimport { AuthenticationState } from '../types/AuthenticationState';\nimport { signIn } from '../thunks/Authentication/signIn';\nimport { signOut } from '../thunks/Authentication/signOut';\nimport { signUp } from '../thunks/Authentication/signUp';\nimport * as firebase from 'firebase/app';\n\nconst initialState: Readonly<AuthenticationState> = Object.freeze({\n    firebaseUser: undefined,\n    loading: true\n});\n\ntype ReducerFunction = (state: AuthenticationState, action: PayloadAction<AuthenticationState>) => void;\ninterface ExtraReducers<ThunkArg = void> {\n    [key: string]: {\n        callback: ReducerFunction;\n        fullfilled: ActionCreatorWithPreparedPayload<[AuthenticationState, string, ThunkArg], AuthenticationState, string, never>;\n    };\n}\n\n// eslint-disable-next-line\nexport function createAuthenticationSlice<ThunkArg = void>(reducers?: ExtraReducers<ThunkArg>, extraReducers?: ExtraReducers<ThunkArg>) {\n    return createSlice({\n        name: 'authentication',\n        initialState,\n        reducers: {\n            setFirebaseUser: (state, action: PayloadAction<firebase.User | null | undefined>): void => {\n                state.firebaseUser = action.payload;\n            },\n            setLoadingFirebaseData: (state, action: PayloadAction<boolean>): void => {\n                state.loading = action.payload;\n            },\n            ...reducers\n        },\n        extraReducers: (builder) => {\n            const replaceAuthenticationState = (state: AuthenticationState, action: PayloadAction<AuthenticationState>): void => {\n                // Used to bypass the has not been read rule\n                if (state != null) {\n                    state = action.payload;\n                }\n            };\n\n            builder.addCase(signIn.fulfilled, replaceAuthenticationState);\n            builder.addCase(signOut.fulfilled, replaceAuthenticationState);\n            builder.addCase(signUp.fulfilled, replaceAuthenticationState);\n\n            // Inject extra reducers\n            if (extraReducers != null) {\n                const keys = Object.keys(extraReducers);\n                if (keys.length > 0) {\n                    for (const reducerKey of keys) {\n                        const data = extraReducers[reducerKey];\n                        builder.addCase(data.fullfilled, data.callback);\n                    }\n                }\n            }\n        }\n    });\n}\n","import * as firebase from 'firebase/app';\nimport { useState, useEffect } from 'react';\nimport { createAuthenticationSlice } from './redux/slices/createAuthenticationSlice';\n\nconst authSlice = createAuthenticationSlice();\nauthSlice.actions.setLoadingFirebaseData(false);\n\ninterface Config {\n    [key: string]: string;\n}\n\ninterface Props {\n    children: JSX.Element;\n    firebaseConfig: Config;\n    loadingComponent: JSX.Element;\n}\n\nexport function Firebase(props: Props): JSX.Element {\n    const [firebaseReady, setFirebaseReady] = useState(false);\n    const { firebaseConfig } = props;\n\n    useEffect(() => {\n        firebase.initializeApp(firebaseConfig);\n        setFirebaseReady(true);\n    }, [firebaseConfig]);\n\n    return firebaseReady ? props.children : props.loadingComponent;\n}\n","import * as firebase from 'firebase/app';\n\nexport interface AuthenticationState {\n    firebaseUser: firebase.User | undefined | null;\n    loading: boolean;\n}\n\nexport function isAuthenticationState(value: unknown): value is AuthenticationState {\n    const castedValue = value as AuthenticationState;\n    return castedValue.loading != null;\n}\n","import { AuthenticationState, isAuthenticationState } from './AuthenticationState';\nimport { UsersState } from './UsersState';\nimport { MinimalUser } from './MinimalUser';\n\nexport type MinimalExpectedReduxState = {\n    authentication: AuthenticationState;\n    users: UsersState<MinimalUser>;\n};\n\nexport function isMinimalExpectedReduxState(value: unknown): value is MinimalExpectedReduxState {\n    const castedValue = value as MinimalExpectedReduxState;\n    return castedValue.authentication != null && isAuthenticationState(castedValue.authentication) && castedValue.users != null;\n}\n","import { useSelector } from 'react-redux';\nimport { AuthenticationState } from '../types/AuthenticationState';\nimport { isMinimalExpectedReduxState } from '../types/MinimalExpectedReduxState';\n\nconst getState = (state: unknown): Readonly<AuthenticationState> => {\n    if (isMinimalExpectedReduxState(state)) {\n        return state.authentication;\n    } else {\n        throw Error('State does not have the expected shape');\n    }\n};\n\nexport const useAuthenticationState = (): Readonly<AuthenticationState> => {\n    return useSelector(getState);\n};\n","import { MinimalUser } from './MinimalUser';\n\nexport interface UsersState<T extends MinimalUser> {\n    users: Map<string, T>;\n}\n\nexport function isUsersState<T extends MinimalUser>(value: unknown): value is UsersState<T> {\n    const casted = value as UsersState<T>;\n    return casted.users != null;\n}\n","import { useSelector } from 'react-redux';\nimport { MinimalUser } from '../types/MinimalUser';\nimport { isUsersState } from '../types/UsersState';\nimport { useAuthenticationState } from './useAuthenticationState';\n\nfunction getUsers<T extends MinimalUser>(state: unknown): Readonly<Map<string, T>> {\n    if (isUsersState<T>(state)) {\n        return state.users;\n    } else {\n        throw Error('State does not have the expected shape');\n    }\n}\n\nexport function useCurrentUser<T extends MinimalUser>(): Readonly<T> | undefined {\n    const authState = useAuthenticationState();\n    const users = useSelector(getUsers);\n    if (authState.firebaseUser != null) {\n        return users.get(authState.firebaseUser.uid) as Readonly<T>;\n    } else {\n        return undefined;\n    }\n}\n","import { useAuthenticationState } from './redux/hooks/useAuthenticationState';\nimport { useCurrentUser } from './redux/hooks/useCurrentUser';\n\ninterface Props {\n    loadingComponent: JSX.Element;\n    authenticationComponent: JSX.Element;\n    userNotAvailableComponent: JSX.Element;\n    children: JSX.Element;\n}\n\nexport function Authenticate(props: Props): JSX.Element {\n    const authenticationState = useAuthenticationState();\n    const currentUser = useCurrentUser();\n    if (authenticationState.firebaseUser === undefined && authenticationState.loading) {\n        return props.loadingComponent;\n    } else if (authenticationState.firebaseUser === null && authenticationState.loading === false) {\n        return props.authenticationComponent;\n    } else {\n        if (currentUser === undefined) {\n            return props.userNotAvailableComponent;\n        } else {\n            return props.children;\n        }\n    }\n}\n","import { createSlice, PayloadAction, ActionCreatorWithPreparedPayload } from '@reduxjs/toolkit';\nimport { UsersState } from '../types/UsersState';\nimport { MinimalUser } from '../types/MinimalUser';\n\ntype UsersMinimalState = UsersState<MinimalUser>;\n\nconst initialState: Readonly<UsersMinimalState> = Object.freeze({\n    users: new Map()\n});\n\ntype ReducerFunction = (state: UsersMinimalState, action: PayloadAction<UsersMinimalState>) => void;\ninterface ExtraReducers<ThunkArg = void> {\n    [key: string]: {\n        callback: ReducerFunction;\n        fullfilled: ActionCreatorWithPreparedPayload<[UsersMinimalState, string, ThunkArg], UsersMinimalState, string, never>;\n    };\n}\n\n// eslint-disable-next-line\nexport function createUsersSlice<ThunkArg = void>(reducers?: ExtraReducers<ThunkArg>, extraReducers?: ExtraReducers<ThunkArg>) {\n    return createSlice({\n        name: 'users',\n        initialState,\n        reducers: {\n            setUser: (state, action: PayloadAction<MinimalUser>): void => {\n                state.users.set(action.payload.id, action.payload);\n            },\n            ...reducers\n        },\n        extraReducers: (builder) => {\n            // Inject extra reducers\n            if (extraReducers != null) {\n                const keys = Object.keys(extraReducers);\n                if (keys.length > 0) {\n                    for (const reducerKey of keys) {\n                        const data = extraReducers[reducerKey];\n                        builder.addCase(data.fullfilled, data.callback);\n                    }\n                }\n            }\n        }\n    });\n}\n"],"names":["signIn","createAsyncThunk","user","firebase","signInWithEmailAndPassword","email","password","userCredential","firebaseUser","loading","signOut","undefined","signUp","createUserWithEmailAndPassword","initialState","Object","freeze","createAuthenticationSlice","reducers","extraReducers","createSlice","name","setFirebaseUser","state","action","payload","setLoadingFirebaseData","builder","replaceAuthenticationState","addCase","fulfilled","keys","length","reducerKey","data","fullfilled","callback","authSlice","actions","Firebase","props","useState","firebaseReady","setFirebaseReady","firebaseConfig","useEffect","children","loadingComponent","isAuthenticationState","value","castedValue","isMinimalExpectedReduxState","authentication","users","getState","Error","useAuthenticationState","useSelector","isUsersState","casted","getUsers","useCurrentUser","authState","get","uid","Authenticate","authenticationState","currentUser","authenticationComponent","userNotAvailableComponent","Map","createUsersSlice","setUser","set","id"],"mappings":"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"}